@inject NavigationManager Navigation

<div class="row mb-4">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
            <div>
                <h1 class="h2 mb-1">Financial Dashboard</h1>
                <p class="text-muted mb-0">
                    @if (SelectedPeriod == "month")
                    {
                        <span>Showing data for @SelectedDate.ToString("MMMM yyyy")</span>
                    }
                    else if (SelectedPeriod == "year")
                    {
                        <span>Showing data for year @SelectedYear</span>
                    }
                    else
                    {
                        <span>Showing data from @(PeriodStartDate?.ToString("MMM d, yyyy") ?? "") to @(PeriodEndDate?.ToString("MMM d, yyyy") ?? "")</span>
                    }
                </p>
            </div>
            <div class="d-flex align-items-center gap-2 flex-wrap">
                <!-- Period Selector -->
                <div class="d-flex align-items-center gap-2 period-filter rounded p-2">
                    <TelerikButtonGroup SelectionMode="@ButtonGroupSelectionMode.Single">
                        <ButtonGroupToggleButton Selected="@(SelectedPeriod == "month")" 
                                                  OnClick="@(() => OnPeriodChanged.InvokeAsync("month"))">
                            Month
                        </ButtonGroupToggleButton>
                        <ButtonGroupToggleButton Selected="@(SelectedPeriod == "year")" 
                                                  OnClick="@(() => OnPeriodChanged.InvokeAsync("year"))">
                            Year
                        </ButtonGroupToggleButton>
                        <ButtonGroupToggleButton Selected="@(SelectedPeriod == "custom")" 
                                                  OnClick="@(() => OnPeriodChanged.InvokeAsync("custom"))">
                            Custom
                        </ButtonGroupToggleButton>
                    </TelerikButtonGroup>
                </div>

                <!-- Date Control Container with fixed width -->
                <div class="date-control-container">
                    @if (SelectedPeriod == "month")
                    {
                        <TelerikDatePicker Value="@SelectedDate"
                                           ValueChanged="@((DateTime value) => { SelectedDate = value; OnDateChanged.InvokeAsync(); })"
                                           Format="MMMM yyyy"
                                           BottomView="@CalendarView.Year"
                                           Width="100%" />
                    }
                    else if (SelectedPeriod == "year")
                    {
                        <TelerikNumericTextBox Value="@SelectedYear"
                                               ValueChanged="@((int value) => { SelectedYear = value; OnYearChanged.InvokeAsync(); })"
                                               Min="2020"
                                               Max="2030"
                                               Width="100%" />
                    }
                    else if (SelectedPeriod == "custom")
                    {
                        <TelerikDateRangePicker StartValue="@PeriodStartDate"
                                                EndValue="@PeriodEndDate"
                                                StartValueChanged="@((DateTime? value) => PeriodStartDate = value)"
                                                EndValueChanged="@((DateTime? value) => { PeriodEndDate = value; OnCustomRangeChanged.InvokeAsync(); })" />
                    }
                </div>

                <TelerikButton ThemeColor="@ThemeConstants.Button.ThemeColor.Primary"
                               OnClick="@(() => OnAddTransaction.InvokeAsync())"
                               Icon="@SvgIcon.Plus">
                    Add Transaction
                </TelerikButton>
                <TelerikButton ThemeColor="@ThemeConstants.Button.ThemeColor.Warning"
                               OnClick="@(() => OnResetData.InvokeAsync())"
                               Icon="@SvgIcon.ArrowRotateCcw">
                    Reset Test Data
                </TelerikButton>
            </div>
        </div>
    </div>
</div>

<style>
    /* Period Filter Button Group Styles */
    .period-filter .k-button-group {
        background: var(--app-surface-2);
        border-radius: var(--bs-border-radius);
        padding: 4px;
        border: 1px solid var(--app-border);
    }

    .period-filter .k-button-group .k-button {
        background: transparent;
        border: none;
        color: var(--app-text-muted);
        font-weight: 500;
        padding: 0.5rem 1rem;
        transition: all 0.15s ease-out;
    }

    .period-filter .k-button-group .k-button:hover {
        background: var(--app-border);
        color: var(--app-text);
    }

    .period-filter .k-button-group .k-button.k-selected,
    .period-filter .k-button-group .k-button:active {
        background: linear-gradient(135deg, var(--app-accent) 0%, #3db89e 100%);
        color: var(--app-bg);
        font-weight: 600;
        box-shadow: 0 2px 6px rgba(78, 201, 176, 0.3);
    }

    /* Date Control Container - Fixed width to prevent layout shift */
    .date-control-container {
        width: 280px;
        min-width: 280px;
        display: flex;
        align-items: flex-end;
    }
</style>


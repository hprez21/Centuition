@using CentuitionApp.Data

<TelerikWindow @bind-Visible="@IsVisible"
               Width="500px"
               Modal="true">
    <WindowTitle>
        @(IsEditing ? "Edit Category" : "Create Category")
    </WindowTitle>
    <WindowContent>
        <EditForm Model="@Category" OnValidSubmit="@OnSave">
            <DataAnnotationsValidator />

            <div class="mb-3">
                <label class="form-label">Category Name <span class="text-danger">*</span></label>
                <TelerikTextBox Value="@Category.Name"
                                ValueChanged="@((string value) => Category.Name = value)"
                                Placeholder="Enter category name"
                                Width="100%"
                                Enabled="@(!Category.IsSystem)" />
                <ValidationMessage For="@(() => Category.Name)" class="text-danger small" />
            </div>

            <div class="mb-3">
                <label class="form-label">Type <span class="text-danger">*</span></label>
                <TelerikDropDownList Data="@CategoryTypes"
                                     Value="@Category.Type"
                                     ValueChanged="@((CategoryType value) => Category.Type = value)"
                                     Width="100%"
                                     Enabled="@(!IsEditing)" />
            </div>

            <div class="mb-3">
                <label class="form-label">Description</label>
                <TelerikTextArea Value="@Category.Description"
                                 ValueChanged="@((string value) => Category.Description = value)"
                                 Placeholder="Optional description"
                                 Rows="2"
                                 Width="100%" />
            </div>

            <div class="row mb-3">
                <div class="col-md-6">
                    <label class="form-label">Color</label>
                    <div>
                        <TelerikColorPicker Value="@CategoryColor"
                                            ValueChanged="@OnColorChanged"
                                            View="@ColorPickerView.Palette" />
                    </div>
                </div>
                <div class="col-md-6">
                    <label class="form-label">Sort Order</label>
                    <TelerikNumericTextBox Value="@Category.SortOrder"
                                           ValueChanged="@((int value) => Category.SortOrder = value)"
                                           Min="0"
                                           Max="999"
                                           Width="100%" />
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label">Preview</label>
                <div class="border rounded p-3 d-flex align-items-center">
                    <div class="rounded-circle me-3"
                         style="width: 32px; height: 32px; background-color: @CategoryColor;"></div>
                    <div>
                        <span class="fw-medium">@(string.IsNullOrEmpty(Category.Name) ? "Category Name" : Category.Name)</span>
                        <br />
                        <small class="text-muted">@Category.Type.ToString()</small>
                    </div>
                </div>
            </div>

            <div class="d-flex justify-content-end gap-2 mt-4">
                <TelerikButton ButtonType="@ButtonType.Button"
                               ThemeColor="@ThemeConstants.Button.ThemeColor.Light"
                               OnClick="@OnCancel">
                    Cancel
                </TelerikButton>
                <TelerikButton ButtonType="@ButtonType.Submit"
                               ThemeColor="@ThemeConstants.Button.ThemeColor.Primary"
                               Icon="@SvgIcon.Save">
                    @(IsEditing ? "Update" : "Create")
                </TelerikButton>
            </div>
        </EditForm>
    </WindowContent>
</TelerikWindow>
